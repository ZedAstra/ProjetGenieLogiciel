import{t as S,a as i,b as x}from"../chunks/BUVNq0sh.js";import{p as M,s as f,a as $,u as P,b as R,g as t,c as n,k as v,l as m,m as b,r as h}from"../chunks/DVbtH7dG.js";import{i as j}from"../chunks/cO9CbSUo.js";import{o as F}from"../chunks/dt_UomYr.js";import{g as k}from"../chunks/L56fx7Z6.js";import{g as G,s as Z,a as y,b as C,c as q,d as H}from"../chunks/uO1cxeyq.js";import"../chunks/BoQ5mhZH.js";import{B as E}from"../chunks/UBRK0isu.js";import"../chunks/B82cbttc.js";import{S as I}from"../chunks/Cs43HK1c.js";var J=S('<div class="flex flex-col"><h1>Zone de danger</h1> <div><!></div></div>'),K=S("<div><!> <!> <!></div>");function te(w,A){M(A,!0);let l=f($([])),d=f($([])),o=f(null);P(()=>{t(o)&&Z(t(o).id)}),F(async()=>{const{data:e,error:a}=await y().GET("/app/projects",{params:{header:{Authorization:C()}}});if(a){console.error(a);return}e&&(n(l,e,!0),n(d,t(l).map(r=>({label:r.nom,value:r})),!0),t(d).length!=0&&n(o,t(l).find(r=>r.id==q()),!0))});async function B(){await H(),k("/")}let s=G();var p=K(),g=v(p);I(g,{label:"Chantier",get options(){return t(d)},placeholder:"Sélectionner un chantier",clearable:!1,get value(){return t(o)},set value(e){n(o,e,!0)}});var _=m(g,2);E(_,{color:"danger",variant:"fill-outline",onclick:async()=>B(),children:(e,a)=>{b();var r=x("Déconnexion");i(e,r)},$$slots:{default:!0}});var T=m(_,2);{var z=e=>{var a=J(),r=m(v(a),2),D=v(r);E(D,{color:"danger",variant:"fill",onclick:async()=>{const{response:u,error:c}=await y().DELETE("/app/projects/{id}",{params:{header:{Authorization:C()},path:{id:t(o).id}}});if(c){console.error(c),alert("Erreur lors de la suppression du chantier");return}u.status==204&&k("/")},children:(u,c)=>{b();var L=x("Supprimer le chantier");i(u,L)},$$slots:{default:!0}}),h(r),h(a),i(e,a)};j(T,e=>{((s==null?void 0:s.userRole)=="Admin"||(s==null?void 0:s.userRole)=="Chef")&&e(z)})}h(p),i(w,p),R()}export{te as component};
